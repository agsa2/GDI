-- Sequência usada para os departamentos.
CREATE SEQUENCE seqDepartamento INCREMENT BY 1 START WITH 1;

-- Tabela Endereço
CREATE TABLE ENDERECO(
    cep VARCHAR2(10),
    rua VARCHAR2(100) NOT NULL,
    bairro VARCHAR2(100) NOT NULL,
    cidade VARCHAR2(100) NOT NULL,
    estado CHAR(2) NOT NULL,
    
    CONSTRAINT ENDERECO_pkey PRIMARY KEY(cep)
);

-- Inserts ENDERECO
INSERT INTO ENDERECO VALUES ('5102323', 'Rua do Sol', 'Boa Vista', 'Recife', 'PE');
INSERT INTO ENDERECO VALUES ('5102324', 'Rua do Fogo', 'Ipanema', 'Rio de Janeiro', 'RJ');
INSERT INTO ENDERECO VALUES ('5102325', 'Rua do Bolo', 'Lake', 'Lagoa', 'RJ');
INSERT INTO ENDERECO VALUES ('5102326', 'Rua da Chuva', 'Mar Fechado', 'São Paulo', 'SP');
INSERT INTO ENDERECO VALUES ('5102327', 'Rua da Água', 'Hearts', 'Belo Horizonte', 'MG');
INSERT INTO ENDERECO VALUES ('5102328', 'Rua da Pizza', 'Diamonds', 'Santa Maria', 'DF');

-- Tabela Pessoa
CREATE TABLE PESSOA(
    id_pessoa INTEGER,
    cep VARCHAR2(10) NOT NULL,
    numero INTEGER NOT NULL,
    
    CONSTRAINT PESSOA_fkey FOREIGN KEY(cep) REFERENCES ENDERECO(cep),
    CONSTRAINT PESSOA_pkey PRIMARY KEY(id_pessoa)
);

-- Inserts Pessoa
INSERT INTO PESSOA VALUES (1, '5102323', 777);
INSERT INTO PESSOA VALUES (2, '5102323', 14);
INSERT INTO PESSOA VALUES (3, '5102324', 19);
INSERT INTO PESSOA VALUES (4, '5102325', 26);
INSERT INTO PESSOA VALUES (5, '5102324', 206);
INSERT INTO PESSOA VALUES (6, '5102328', 789);
INSERT INTO PESSOA VALUES (7, '5102327', 114);
INSERT INTO PESSOA VALUES (8, '5102324', 2);
INSERT INTO PESSOA VALUES (9, '5102326', 67);
INSERT INTO PESSOA VALUES (10, '5102326', 13);

-- Tabela para os telefones das pessoas
CREATE TABLE TELEFONE(
    id_pessoa_telefone INTEGER,
    num_telefone VARCHAR(15),
    
    CONSTRAINT TELEFONE_fkey FOREIGN KEY(id_pessoa_telefone) REFERENCES PESSOA(id_pessoa)
);

-- Inserts: telefone
INSERT INTO TELEFONE VALUES (1, 8134648400);
INSERT INTO TELEFONE VALUES (1, 8198763432);
INSERT INTO TELEFONE VALUES (2, 8134648410);
INSERT INTO TELEFONE VALUES (3, 8198763423);
INSERT INTO TELEFONE VALUES (4, 8134648421);
INSERT INTO TELEFONE VALUES (5, 8198763422);
INSERT INTO TELEFONE VALUES (6, 8134648423);
INSERT INTO TELEFONE VALUES (7, 8198763424);
INSERT INTO TELEFONE VALUES (8, 8134648425);
INSERT INTO TELEFONE VALUES (9, 8198763433);
INSERT INTO TELEFONE VALUES (9, 8194763433);
INSERT INTO TELEFONE VALUES (10, 8197783433);

-- Tabela para os emails das pessoas
CREATE TABLE EMAIL(
    id_pessoa_email INTEGER,
    endereco_email VARCHAR(50),
    
    CONSTRAINT EMAIL_fkey FOREIGN KEY(id_pessoa_email) REFERENCES PESSOA(id_pessoa)
); 

-- Inserts: email
INSERT INTO EMAIL VALUES (1, 'email1@msn.com');
INSERT INTO EMAIL VALUES (2, 'email2@msn.com');
INSERT INTO EMAIL VALUES (3, 'email3@hotmail.com');
INSERT INTO EMAIL VALUES (4, 'email4@uol.com');
INSERT INTO EMAIL VALUES (4, 'email5@cin.ufpe.br');
INSERT INTO EMAIL VALUES (5, 'email6@gmail.com');
INSERT INTO EMAIL VALUES (6, 'email7@gmail.com');
INSERT INTO EMAIL VALUES (6, 'email8@gmail.com');
INSERT INTO EMAIL VALUES (7, 'email11@gmail.com');
INSERT INTO EMAIL VALUES (8, 'email61@gmail.com');
INSERT INTO EMAIL VALUES (9, 'email81@gmail.com');
INSERT INTO EMAIL VALUES (9, 'email110@gmail.com');
INSERT INTO EMAIL VALUES (10, 'email614@gmail.com');

-- Tabela EMPRESA
CREATE TABLE EMPRESA(
    id_pessoa_empresa INTEGER,
    cnpj VARCHAR2(20) NOT NULL, 
    razao_social VARCHAR2(50) NOT NULL,
    nome_fantasia VARCHAR2(50) NOT NULL,
    
    CONSTRAINT EMPRESA_const UNIQUE(cnpj),
    CONSTRAINT EMPRESA_fkey FOREIGN KEY(id_pessoa_empresa) REFERENCES PESSOA(id_pessoa),
    CONSTRAINT EMPRESA_pkey PRIMARY KEY(id_pessoa_empresa)
);

-- Inserts: EMPRESA
INSERT INTO EMPRESA VALUES (1, 14233567000123, 'EMPRESA 1 RS', 'EMPRESA 1');
INSERT INTO EMPRESA VALUES (2, 14233567000124, 'EMPRESA 2 RS', 'EMPRESA 2');
INSERT INTO EMPRESA VALUES (3, 14233567000125, 'EMPRESA 3 RS', 'EMPRESA 3');
INSERT INTO EMPRESA VALUES (4, 14233567000126, 'EMPRESA 4 RS', 'EMPRESA 4');

-- Tabela de Pessoa Física
CREATE TABLE PESSOA_FISICA(
    id_pessoa_fisica INTEGER,
    cpf VARCHAR2(15) NOT NULL,
    nome VARCHAR2(100) NOT NULL,
    data_de_nascimento DATE,
    
    CONSTRAINT PESSOA_FISICA_const UNIQUE(cpf),
    CONSTRAINT PESSOA_FISICA_fkey FOREIGN KEY(id_pessoa_fisica) REFERENCES PESSOA(id_pessoa),
    CONSTRAINT PESSOA_FISICA_pkey PRIMARY KEY(id_pessoa_fisica)
);

-- Inserts: PESSOA_FÍSICA
INSERT INTO PESSOA_FISICA VALUES (5, 11111111111, 'ANA BEATRIZ GOMES', '04-FEB-1981');
INSERT INTO PESSOA_FISICA VALUES (6, 22222222222, 'GERALDO FRANSCICO DA SILVA', '05-MAR-1982');
INSERT INTO PESSOA_FISICA VALUES (7, 33333333333, 'MARIANA SOARES DE LIMA', '06-APR-1983');
INSERT INTO PESSOA_FISICA VALUES (8, 44455566666, 'LUIZ MELO DE SOUZA', '07-MAY-1984');
INSERT INTO PESSOA_FISICA VALUES (9, 77777777777, 'MARIA LUIZA FERREIRA', '08-OCT-1984');
INSERT INTO PESSOA_FISICA VALUES (10, 88888888888, 'VINÍCIUS DE MORAES', '09-DEC-2001');

-- Tabela de Sócios
CREATE TABLE SOCIO(
    id_socio INTEGER,
    numero_registro INTEGER,
    data_afiliacao DATE,
    valor_investimento NUMBER(10,2), 
    porcentagem_nos_lucros FLOAT(2),
    
    CONSTRAINT SOCIO_const UNIQUE(numero_registro),
    CONSTRAINT SOCIO_fkey FOREIGN KEY(id_socio) REFERENCES PESSOA_FISICA(id_pessoa_fisica),
    CONSTRAINT SOCIO_pkey PRIMARY KEY(id_socio)
);

-- Inserts: SÓCIOS
INSERT INTO SOCIO VALUES (5, 12, '11-DEC-2020', 258967.14, 0.15);
INSERT INTO SOCIO VALUES (6, 24, '05-MAR-1982', 57601.66, 0.05);

-- Tabela de DEPARTAMENTOS
CREATE TABLE DEPARTAMENTO(
    numero INTEGER,
    id_empresa_dep INTEGER, 
    nome VARCHAR2(80),
    data_criacao DATE,
    situacao CHAR(1),
    
    CONSTRAINT DEPARTAMENTO_fkey FOREIGN KEY(id_empresa_dep) REFERENCES EMPRESA(id_pessoa_empresa),
    CONSTRAINT DEPARTAMENTO_pkey PRIMARY KEY(numero),
    
    CONSTRAINT DEPARTAMENTO_check CHECK(situacao = 'A' OR situacao = 'I')

);

-- INSERT: DEPARTAMENTO
INSERT INTO DEPARTAMENTO VALUES(seqDepartamento.nextval, 1, 'DEPARTAMENTO 1', '07-FEB-2014', 'A');
INSERT INTO DEPARTAMENTO VALUES(seqDepartamento.nextval, 1, 'DEPARTAMENTO 2', '02-FEB-2014', 'A');
INSERT INTO DEPARTAMENTO VALUES(seqDepartamento.nextval, 1, 'DEPARTAMENTO 3', '01-FEB-2014', 'A');
INSERT INTO DEPARTAMENTO VALUES(seqDepartamento.nextval, 1, 'DEPARTAMENTO 4', '05-MAY-2013', 'I');
INSERT INTO DEPARTAMENTO VALUES(seqDepartamento.nextval, 2, 'DEPARTAMENTO 1', '11-APR-2016', 'A');
INSERT INTO DEPARTAMENTO VALUES(seqDepartamento.nextval, 2, 'DEPARTAMENTO 2', '11-OCT-2017', 'A');
INSERT INTO DEPARTAMENTO VALUES(seqDepartamento.nextval, 3, 'DEPARTAMENTO S2', '04-NOV-2019', 'A');
INSERT INTO DEPARTAMENTO VALUES(seqDepartamento.nextval, 4, 'DEPARTAMENTO 39', '03-DEC-2011', 'A');

-- Tabela de CONTRATO
CREATE TABLE CONTRATO(
    numero_contrato INTEGER,
    tipo_contrato VARCHAR2(80),
    data_admissao DATE, 
    cargo VARCHAR2(50), 
    salario_bruto_mensal NUMBER(10,2),
    jornada_trabalho_semanal INTEGER,
    
    CONSTRAINT CONTRATO_pkey PRIMARY KEY(numero_contrato),

    CONSTRAINT CONTRATO_check1 CHECK(salario_bruto_mensal >= 1100.00),
    CONSTRAINT CONTRATO_check2 CHECK(jornada_trabalho_semanal <= 44)
);

-- INSERT CONTRATO
INSERT INTO CONTRATO VALUES (12, 'CLT', '12-DEC-2012', 'OPERADOR 1', 1736.26, 44);
INSERT INTO CONTRATO VALUES (14, 'CLT', '10-DEC-2013', 'OPERADOR CHEFE', 2336.62, 44);
INSERT INTO CONTRATO VALUES (28, 'PJ', '05-MAY-2021', 'DESENVOLVEDOR ANDROID', 6047.66, 30);
INSERT INTO CONTRATO VALUES (56, 'ESTÁGIO', '11-APR-2020', 'DESENVOLVEDOR PHP', 1200, 20);

-- Tabela de FUNCIONÁRIOS
CREATE TABLE FUNCIONARIO(
    id_funcionario INTEGER,
    ctps VARCHAR2(15),
    numero_departamento INTEGER, 
    id_gerente INTEGER, 
    numero_contrato_func INTEGER, 
    id_empresa_func INTEGER, 
    
    CONSTRAINT FUNCIONARIO_const UNIQUE(ctps),
    
    CONSTRAINT FUNCIONARIO_fkey1 FOREIGN KEY(numero_departamento) -- FK Dep
        REFERENCES DEPARTAMENTO(numero),
    
    CONSTRAINT FUNCIONARIO_fkey2 FOREIGN KEY(numero_contrato_func) -- FK Contrato
        REFERENCES CONTRATO(numero_contrato),
    
    CONSTRAINT FUNCIONARIO_fkey3 FOREIGN KEY(id_empresa_func) -- FK Empresa
        REFERENCES EMPRESA(id_pessoa_empresa),
    
    CONSTRAINT FUNCIONARIO_pkey PRIMARY KEY(id_funcionario), -- PK
    
    CONSTRAINT FUNCIONARIO_fkey4 FOREIGN KEY(id_gerente) -- Auto relacionamento
        REFERENCES FUNCIONARIO(id_funcionario)
);

INSERT INTO FUNCIONARIO VALUES(7, '12345', 1, NULL, 12, 1);
INSERT INTO FUNCIONARIO VALUES(8, '12346', 2, NULL, 14, 2);
INSERT INTO FUNCIONARIO VALUES(9, '12347', 5, NULL, 28, 3);
INSERT INTO FUNCIONARIO VALUES(10, '12348', 8, NULL, 56, 4);


-- Tabela CONTA BANCÁRIA
CREATE TABLE CONTA_BANCARIA(
    agencia INTEGER, 
    numero_conta INTEGER,
    numero_banco INTEGER, 
    id_titular INTEGER, 
    
    CONSTRAINT CONTA_BANCARIA_fkey FOREIGN KEY(id_titular)
        REFERENCES PESSOA(id_pessoa),
    
    CONSTRAINT CONTA_BANCARIA_pkey PRIMARY KEY(agencia, numero_conta)
);

INSERT INTO CONTA_BANCARIA VALUES(1, 1234, 10, 1);
INSERT INTO CONTA_BANCARIA VALUES(2, 1235, 10, 2);
INSERT INTO CONTA_BANCARIA VALUES(3, 1236, 11, 3);
INSERT INTO CONTA_BANCARIA VALUES(4, 1237, 12, 4);
INSERT INTO CONTA_BANCARIA VALUES(5, 1238, 14, 5);
INSERT INTO CONTA_BANCARIA VALUES(5, 1239, 15, 6);
INSERT INTO CONTA_BANCARIA VALUES(5, 1221, 15, 7);
INSERT INTO CONTA_BANCARIA VALUES(4, 1222, 15, 8);
INSERT INTO CONTA_BANCARIA VALUES(6, 1223, 18, 9);
INSERT INTO CONTA_BANCARIA VALUES(9, 1224, 18, 10);

-- Tabela VANTAGENS
CREATE TABLE VANTAGEM(
    codigo INTEGER, 
    descricao VARCHAR2(50),
    valor NUMBER(10,2),
    
    CONSTRAINT VANTAGEM_pkey PRIMARY KEY(codigo)
);

INSERT INTO VANTAGEM VALUES(1, 'VANTAGEM 1', 220);
INSERT INTO VANTAGEM VALUES(3, 'VANTAGEM 2', 114.51);
INSERT INTO VANTAGEM VALUES(9, 'VANTAGEM 3', 361.14);
INSERT INTO VANTAGEM VALUES(5, 'VANTAGEM 4', 845.11);
INSERT INTO VANTAGEM VALUES(7, 'VANTAGEM 5', 505);

-- Tabela DESCONTOS
CREATE TABLE DESCONTO(
    codigo INTEGER, 
    descricao VARCHAR2(50),
    valor NUMBER(10,2),
    
    CONSTRAINT DESCONTO_pkey PRIMARY KEY(codigo)
);

INSERT INTO DESCONTO VALUES(1, 'DESCONTO 1', 110);
INSERT INTO DESCONTO VALUES(2, 'DESCONTO 3', 74.15);
INSERT INTO DESCONTO VALUES(4, 'DESCONTO 9', 180.41);
INSERT INTO DESCONTO VALUES(6, 'DESCONTO 7', 425.11);
INSERT INTO DESCONTO VALUES(8, 'DESCONTO 5', 220.5);

-- Tabela PONTO
CREATE TABLE PONTO(
    protocolo INTEGER,
    data_atual DATE, 
    funcionario INTEGER, 
    
    CONSTRAINT PONTO_fkey FOREIGN KEY(funcionario) -- FK Empresa
        REFERENCES FUNCIONARIO(id_funcionario),
        
    CONSTRAINT PONTO_pkey PRIMARY KEY(protocolo)
);

INSERT INTO PONTO VALUES(1, '14-JULY-2021', 7);
INSERT INTO PONTO VALUES(2, '14-JULY-2021', 8);
INSERT INTO PONTO VALUES(3, '14-JULY-2021', 9);
INSERT INTO PONTO VALUES(4, '14-JULY-2021', 10);

-- Tabela Entrada
CREATE TABLE ENTRADA(
    hora_entrada TIMESTAMP, 
    protocolo_ponto INTEGER,
    
    CONSTRAINT ENTRADA_fkey FOREIGN KEY(protocolo_ponto)
        REFERENCES PONTO(protocolo),
        
    CONSTRAINT ENTRADA_pkey PRIMARY KEY(hora_entrada, protocolo_ponto)
);

INSERT INTO ENTRADA VALUES('14-JUL-21 03.57.31.551717 PM', 1);
INSERT INTO ENTRADA VALUES('14-JUL-21 03.57.31.558180 PM', 2);
INSERT INTO ENTRADA VALUES('14-JUL-21 03.57.31.562065 PM', 3);
INSERT INTO ENTRADA VALUES('14-JUL-21 03.57.31.565679 PM', 4);

-- Tabela SAÍDA
CREATE TABLE SAIDA(
    hora_saida TIMESTAMP,
    hora_entrada TIMESTAMP,
    protocolo_ponto INTEGER,
    
    CONSTRAINT SAIDA_fkey FOREIGN KEY(hora_entrada, protocolo_ponto)
        REFERENCES ENTRADA(hora_entrada, protocolo_ponto),
        
    CONSTRAINT SAIDA_pkey PRIMARY KEY(hora_saida, hora_entrada, protocolo_ponto)
);

INSERT INTO SAIDA VALUES(CURRENT_TIMESTAMP, '14-JUL-21 03.57.31.551717 PM', 1);
INSERT INTO SAIDA VALUES(CURRENT_TIMESTAMP, '14-JUL-21 03.57.31.558180 PM', 2);
INSERT INTO SAIDA VALUES(CURRENT_TIMESTAMP, '14-JUL-21 03.57.31.562065 PM', 3);
INSERT INTO SAIDA VALUES(CURRENT_TIMESTAMP, '14-JUL-21 03.57.31.565679 PM', 4);


-- Tabela PARTICIPAÇÃO
CREATE TABLE PARTICIPACAO(
    socio INTEGER, 
    empresa INTEGER, 
    
    CONSTRAINT PARTICIPACAO_fkey1 FOREIGN KEY(socio)
        REFERENCES SOCIO(id_socio),
        
    CONSTRAINT PARTICIPACAO_fkey2 FOREIGN KEY(empresa)
        REFERENCES EMPRESA(id_pessoa_empresa),
        
    CONSTRAINT PARTICIPACAO_pkey PRIMARY KEY(socio, empresa)
);

INSERT INTO PARTICIPACAO VALUES(5, 1);
INSERT INTO PARTICIPACAO VALUES(6, 2);

-- Tabela Bônus
CREATE TABLE BONUS(
    identificador INTEGER, 
    porcentagem_bonus FLOAT(2), 
    socio_bonus INTEGER, 
    empresa_bonus INTEGER, 
    
    CONSTRAINT PARTICIPACAO_fkey FOREIGN KEY(socio_bonus, empresa_bonus)
        REFERENCES PARTICIPACAO(socio, empresa),
    
    CONSTRAINT BONUS_pkey PRIMARY KEY(identificador)
);

INSERT INTO BONUS VALUES (11, 0.1, 5, 1);
INSERT INTO BONUS VALUES (20, 0.25, 6, 2);

-- Tabela ACRÉSCIMO
CREATE TABLE ACRESCIMO(
    codigo_vantagem INTEGER, 
    num_contrato INTEGER, 
    
    CONSTRAINT ACRESCIMO_fkey1 FOREIGN KEY(codigo_vantagem)
        REFERENCES VANTAGEM(codigo),
        
    CONSTRAINT ACRESCIMO_fkey2 FOREIGN KEY(num_contrato)
        REFERENCES CONTRATO(numero_contrato),
        
    CONSTRAINT ACRESCIMO_pkey PRIMARY KEY(codigo_vantagem, num_contrato)
);

INSERT INTO ACRESCIMO VALUES(1, 14);
INSERT INTO ACRESCIMO VALUES(3, 14);
INSERT INTO ACRESCIMO VALUES(7, 28);
INSERT INTO ACRESCIMO VALUES(7, 12);
INSERT INTO ACRESCIMO VALUES(3, 56);
INSERT INTO ACRESCIMO VALUES(5, 12);

-- Tabela APLICAÇÃO
CREATE TABLE APLICACAO(
    codigo_desconto INTEGER, 
    num_contrato INTEGER, 
    
    CONSTRAINT APLICACAO_fkey1 FOREIGN KEY(codigo_desconto)
        REFERENCES DESCONTO(codigo),
        
    CONSTRAINT APLICACAO_fkey2 FOREIGN KEY(num_contrato)
        REFERENCES CONTRATO(numero_contrato),
        
    CONSTRAINT APLICACAO_pkey PRIMARY KEY(codigo_DESCONTO, num_contrato)
);

INSERT INTO APLICACAO VALUES(1, 14);
INSERT INTO APLICACAO VALUES(2, 14);
INSERT INTO APLICACAO VALUES(4, 28);
INSERT INTO APLICACAO VALUES(8, 12);
INSERT INTO APLICACAO VALUES(6, 56);
INSERT INTO APLICACAO VALUES(6, 12);

CREATE TABLE PAGAMENTO(
    empresa INTEGER, 
    funcionario INTEGER, 
    data_pagamento DATE, 

    CONSTRAINT PAGAMENTO_fkey1 FOREIGN KEY(empresa)
        REFERENCES EMPRESA(id_pessoa_empresa),
        
    CONSTRAINT PAGAMENTO_fkey2 FOREIGN KEY(funcionario)
        REFERENCES FUNCIONARIO(id_funcionario),
    
    CONSTRAINT PAGAMENTO_pkey PRIMARY KEY(empresa, funcionario, data_pagamento)
);

-- INSERT PAGAMENTO

INSERT INTO PAGAMENTO VALUES(1, 7, '12-JAN-2021');
INSERT INTO PAGAMENTO VALUES(1, 7, '12-FEB-2021');
INSERT INTO PAGAMENTO VALUES(1, 7, '12-MAR-2021');
INSERT INTO PAGAMENTO VALUES(2, 8, '20-JAN-2021');
INSERT INTO PAGAMENTO VALUES(2, 8, '12-FEB-2021');
INSERT INTO PAGAMENTO VALUES(2, 8, '12-MAR-2021');
INSERT INTO PAGAMENTO VALUES(2, 8, '12-APR-2021');
INSERT INTO PAGAMENTO VALUES(3, 9, '12-APR-2021');
INSERT INTO PAGAMENTO VALUES(4, 10, '12-MAY-2021');
INSERT INTO PAGAMENTO VALUES(4, 10, '12-JUNE-2021');